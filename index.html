<!DOCTYPE HTML>
<html>
  <head>
  </head>
  <body>
    <div id="gists"></div>

    <!-- files -->

    <script src="tinytim.min.js"></script>
    <script src="ghre.js"></script>

    <!-- templates -->

    <script type="text/tim" id="gistdiv">
        <div class="gist" data-id="{{id}}">
          <a href='{{html_url}}'>{{description}}</a>
          <ul class="files">{{files}}</ul>
        </div>
    </script>

    <script type="text/tim" id="filediv">
        <li><a href='{{html_url}}'>{{filename}}</a> {{language}} {{size}} <a href="{{raw_url}}">raw</a></li>
    </script>

    <script type="text/tim" id="filediv">
        <div style="color:#{{color}};"><a href='{{url}}'>{{name}}</a></div>
    </script>

    <!-- scripts -->

    <script type="text/javascript">
      var gist = document.getElementById("gistdiv").innerHTML;
      var file = document.getElementById("filediv").innerHTML;
      var label = document.getElementById("labels").innerHTML;

      // getURLInfo() completes immediately...
      getAPI(
        "repos/petrosh/diarissues/issues",
        // ...however, the callback function is invoked AFTER the response arrives
        function() {
          // "this" is the XHR object here!
          var resp = JSON.parse(this.responseText);
          for (var key in resp) {
            if (resp.hasOwnProperty(key)) {
              var obj = resp[key];
              console.log(obj);
              getAPI(
                "repos/petrosh/diarissues/milestones",
                // ...however, the callback function is invoked AFTER the response arrives
                function() {
                  // "this" is the XHR object here!
                  var resp = JSON.parse(this.responseText);
                  for (var key in resp) {
                    if (resp.hasOwnProperty(key)) {
                      var obj = resp[key];
                      console.log(obj);
                      // var singlef = '';
                      // for (var f in obj['files']) {
                      //   if (obj['files'].hasOwnProperty(f)){
                      //     singlef += tim(file, obj['files'][f]);
                      //   }
                      // };
                      //var rep = tim(gist, obj);
                      //document.getElementById("gists").innerHTML += rep;
                    }
                  }
                }
              );
              var singlel = '';
              for (var f in obj['labels']) {
                if (obj['labels'].hasOwnProperty(f)){
                  singlef += tim(label, obj['labels'][f]);
                }
              };
              //var rep = tim(gist, obj);
              //document.getElementById("gists").innerHTML += rep;
            }
          }
        }
      );
    </script>
  </body>
</html>
